<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Logs | The Digiquarium</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a24;
            --text-primary: #e0e0e0;
            --text-secondary: #888;
            --accent-cyan: #00d4ff;
            --accent-green: #00ff88;
            --accent-orange: #FE6500;
            --border: #2a2a3a;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }
        
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            color: var(--accent-cyan);
            font-size: 1.5em;
        }
        
        .header a {
            color: var(--text-secondary);
            text-decoration: none;
        }
        
        .header a:hover { color: var(--accent-cyan); }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }
        
        .info-banner {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid var(--accent-cyan);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .info-banner h2 {
            color: var(--accent-cyan);
            margin-bottom: 10px;
        }
        
        .info-banner p {
            color: var(--text-secondary);
            line-height: 1.6;
        }
        
        .info-banner .stats {
            display: flex;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .info-banner .stat {
            background: var(--bg-card);
            padding: 10px 20px;
            border-radius: 8px;
        }
        
        .info-banner .stat-value {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--accent-green);
        }
        
        .info-banner .stat-label {
            font-size: 0.85em;
            color: var(--text-secondary);
        }
        
        .prune-notice {
            background: rgba(254, 101, 0, 0.1);
            border: 1px solid var(--accent-orange);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.9em;
        }
        
        .prune-notice strong { color: var(--accent-orange); }
        
        .tank-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tank-btn {
            padding: 10px 20px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-card);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tank-btn:hover, .tank-btn.active {
            border-color: var(--accent-cyan);
            background: rgba(0, 212, 255, 0.1);
        }
        
        .log-container {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .log-header {
            background: var(--bg-secondary);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .log-header h3 { color: var(--accent-cyan); }
        
        .log-entries {
            max-height: 600px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85em;
        }
        
        .log-entry {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
        }
        
        .log-entry:hover {
            background: var(--bg-secondary);
        }
        
        .log-entry .meta {
            display: flex;
            gap: 20px;
            margin-bottom: 10px;
            font-size: 0.9em;
        }
        
        .log-entry .timestamp { color: var(--text-secondary); }
        .log-entry .article { color: var(--accent-cyan); font-weight: 600; }
        .log-entry .next { color: var(--accent-green); }
        
        .log-entry .thoughts {
            color: var(--text-primary);
            line-height: 1.6;
            padding: 10px;
            background: var(--bg-secondary);
            border-radius: 6px;
            white-space: pre-wrap;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }
        
        .refresh-btn {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .refresh-btn:hover { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìú Live Thinking Logs</h1>
        <nav>
            <a href="../">‚Üê Back to Dashboard</a>
        </nav>
    </div>
    
    <div class="container">
        <div class="info-banner">
            <h2>üß† What You're Seeing</h2>
            <p>
                These are the actual thinking traces from our AI specimens as they explore Wikipedia.
                Each entry shows what article they're reading, their genuine thoughts about it, 
                and where they chose to navigate next.
            </p>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="total-entries">--</div>
                    <div class="stat-label">Clean Entries</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="tanks-count">--</div>
                    <div class="stat-label">Active Tanks</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="last-updated">--</div>
                    <div class="stat-label">Last Updated</div>
                </div>
            </div>
            
            <div class="prune-notice">
                <strong>üßπ Data Quality Notice:</strong> These logs are automatically pruned by THE WEBMASTER.
                Entries with null thoughts (LLM timeouts), errors, and malformed data are filtered out.
                You're seeing only genuine, clean thinking traces.
            </div>
        </div>
        
        <div class="tank-selector" id="tank-selector">
            <!-- Populated by JS -->
        </div>
        
        <div class="log-container">
            <div class="log-header">
                <h3 id="current-tank">Select a tank above</h3>
                <button class="refresh-btn" onclick="loadLogs()">‚Üª Refresh</button>
            </div>
            <div class="log-entries" id="log-entries">
                <div class="no-data">Select a tank to view their thinking logs</div>
            </div>
        </div>
    </div>
    
    <script>
        let currentTank = null;
        let summary = null;
        
        async function loadSummary() {
            try {
                const response = await fetch('logs-public/summary.json?' + Date.now());
                summary = await response.json();
                
                document.getElementById('total-entries').textContent = summary.entries_published.toLocaleString();
                document.getElementById('tanks-count').textContent = summary.tanks_processed;
                document.getElementById('last-updated').textContent = new Date(summary.last_updated).toLocaleTimeString();
                
                // Load tank list
                loadTankList();
            } catch (e) {
                console.error('Failed to load summary:', e);
            }
        }
        
        async function loadTankList() {
            const selector = document.getElementById('tank-selector');
            
            // Known tanks
            const tanks = [
                'tank-01-adam', 'tank-02-eve', 'tank-03-cain', 'tank-04-abel',
                'tank-05-juan', 'tank-06-juanita', 'tank-07-klaus', 'tank-08-genevieve',
                'tank-09-wei', 'tank-10-mei', 'tank-11-haruki', 'tank-12-sakura',
                'tank-13-victor', 'tank-14-iris', 'tank-15-observer', 'tank-16-seeker', 'tank-17-seth'
            ];
            
            selector.innerHTML = tanks.map(tank => {
                const displayName = tank.replace('tank-', '').replace(/-/g, ' ').toUpperCase();
                return `<button class="tank-btn" onclick="selectTank('${tank}')">${displayName}</button>`;
            }).join('');
        }
        
        async function selectTank(tank) {
            currentTank = tank;
            
            // Update button states
            document.querySelectorAll('.tank-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.toLowerCase().includes(tank.split('-')[2]));
            });
            
            document.getElementById('current-tank').textContent = tank.replace('tank-', '').replace(/-/g, ' ').toUpperCase();
            
            await loadLogs();
        }
        
        async function loadLogs() {
            if (!currentTank) return;
            
            const container = document.getElementById('log-entries');
            container.innerHTML = '<div class="loading">Loading...</div>';
            
            try {
                // Get today's date for the log file
                const today = new Date().toISOString().split('T')[0];
                const response = await fetch(`logs-public/${currentTank}/${today}.jsonl?` + Date.now());
                
                if (!response.ok) {
                    container.innerHTML = '<div class="no-data">No logs available for today</div>';
                    return;
                }
                
                const text = await response.text();
                const lines = text.trim().split('\n').filter(l => l);
                
                if (lines.length === 0) {
                    container.innerHTML = '<div class="no-data">No entries yet today</div>';
                    return;
                }
                
                // Parse and display (most recent first)
                const entries = lines.map(line => JSON.parse(line)).reverse();
                
                container.innerHTML = entries.slice(0, 50).map(entry => `
                    <div class="log-entry">
                        <div class="meta">
                            <span class="timestamp">${new Date(entry.timestamp).toLocaleTimeString()}</span>
                            <span class="article">üìñ ${entry.article}</span>
                            <span class="next">‚Üí ${entry.next || '?'}</span>
                        </div>
                        <div class="thoughts">${escapeHtml(entry.thoughts || 'No thoughts recorded')}</div>
                    </div>
                `).join('');
                
            } catch (e) {
                console.error('Failed to load logs:', e);
                container.innerHTML = '<div class="no-data">Error loading logs</div>';
            }
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Initialize
        loadSummary();
        
        // Auto-refresh every 60 seconds
        setInterval(() => {
            loadSummary();
            if (currentTank) loadLogs();
        }, 60000);
    </script>
</body>
</html>
