<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mei | The Digiquarium</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        :root { --black: #000001; --dark: #000A09; --orange: #FE6500; --mint: #07CF8D; --cyan: #07DDE7; --white: #ffffff; --gray: #8899a6; --specimen: #22D3EE; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--black); color: var(--white); line-height: 1.7; }
        a { color: var(--cyan); text-decoration: none; }
        a:hover { color: var(--mint); }
        
        .header { background: var(--dark); padding: 15px 25px; border-bottom: 1px solid rgba(7, 207, 141, 0.1); }
        .header-inner { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1rem; font-weight: 700; color: var(--white); display: flex; align-items: center; gap: 8px; }
        .logo span { background: linear-gradient(90deg, var(--mint), var(--cyan)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        nav a { margin-left: 18px; color: var(--gray); font-size: 0.85rem; }
        nav a:hover { color: var(--white); }
        .compare-btn { background: var(--orange); color: var(--white); padding: 6px 14px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; border: none; margin-left: 18px; }
        
        .profile-hero { padding: 50px 25px; text-align: center; border-bottom: 1px solid rgba(7, 207, 141, 0.1); background: linear-gradient(180deg, var(--dark) 0%, var(--black) 100%); }
        .avatar { width: 100px; height: 100px; margin: 0 auto 18px; }
        .avatar svg { width: 100%; height: 100%; }
        .specimen-name { font-size: 2.5rem; margin-bottom: 8px; color: var(--specimen); }
        .specimen-type { color: var(--gray); font-size: 0.95rem; margin-bottom: 4px; }
        .specimen-meta { color: var(--gray); font-size: 0.85rem; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 25px; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 40px; }
        .stat-card { background: var(--dark); padding: 20px; border-radius: 10px; text-align: center; border: 1px solid rgba(7, 207, 141, 0.1); }
        .stat-value { font-size: 1.8rem; font-weight: 700; color: var(--specimen); }
        .stat-label { font-size: 0.7rem; color: var(--gray); margin-top: 4px; text-transform: uppercase; }
        
        .section { margin-bottom: 40px; }
        .section h2 { font-size: 1.2rem; color: var(--cyan); margin-bottom: 15px; padding-bottom: 8px; border-bottom: 1px solid rgba(7, 207, 141, 0.1); }
        
        .mindmap-section { background: var(--dark); border-radius: 12px; border: 1px solid rgba(7, 207, 141, 0.2); overflow: hidden; margin-bottom: 40px; }
        .mindmap-header { padding: 20px; border-bottom: 1px solid rgba(7, 207, 141, 0.1); display: flex; justify-content: space-between; align-items: center; }
        .mindmap-header h2 { color: var(--cyan); margin: 0; border: none; padding: 0; }
        #mindmap { width: 100%; height: 500px; background: var(--black); position: relative; }
        .zoom-controls { position: absolute; top: 10px; right: 10px; display: flex; gap: 5px; z-index: 100; }
        .zoom-btn { width: 32px; height: 32px; border-radius: 6px; border: 1px solid rgba(7, 207, 141, 0.3); background: var(--dark); color: var(--white); cursor: pointer; font-size: 1.2rem; }
        .node circle { stroke: var(--specimen); stroke-width: 1px; cursor: pointer; }
        .node text { font-family: 'Inter', sans-serif; font-size: 9px; fill: var(--white); pointer-events: none; }
        .link { stroke: var(--cyan); stroke-opacity: 0.3; }
        
        .time-slider-container { padding: 15px 20px; background: rgba(0,0,0,0.3); border-top: 1px solid rgba(7, 207, 141, 0.1); }
        .time-slider-label { display: flex; justify-content: space-between; margin-bottom: 10px; color: var(--gray); font-size: 0.85em; }
        #time-slider { width: 100%; height: 8px; -webkit-appearance: none; background: var(--dark); border-radius: 4px; }
        #time-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: var(--specimen); cursor: pointer; }
        .play-btn { background: var(--dark); border: 1px solid var(--specimen); color: var(--specimen); padding: 8px 16px; border-radius: 6px; cursor: pointer; margin-right: 10px; }
        
        .interests { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px; }
        .interest { background: var(--dark); padding: 8px 14px; border-radius: 20px; display: flex; align-items: center; gap: 8px; border: 1px solid rgba(7, 207, 141, 0.2); }
        .interest .count { background: var(--specimen); color: var(--black); padding: 2px 8px; border-radius: 10px; font-size: 0.75em; font-weight: 600; }
        
        .special-interest { background: linear-gradient(135deg, rgba(7, 207, 141, 0.1), rgba(7, 221, 231, 0.1)); border: 1px solid rgba(7, 207, 141, 0.3); border-radius: 12px; padding: 25px; margin-bottom: 40px; }
        .special-interest h3 { color: var(--mint); margin-bottom: 15px; }
        .special-interest-badge { display: inline-block; background: var(--specimen); color: var(--black); padding: 5px 15px; border-radius: 20px; font-weight: 600; margin-bottom: 15px; }
        
        .journey-section { background: var(--dark); border-radius: 12px; padding: 25px; margin-bottom: 40px; border: 1px solid rgba(7, 207, 141, 0.2); }
        .journey-title { color: var(--orange); font-size: 1.2rem; margin-bottom: 20px; }
        .journey-timeline { position: relative; padding-left: 30px; }
        .journey-timeline::before { content: ''; position: absolute; left: 8px; top: 0; bottom: 0; width: 2px; background: linear-gradient(180deg, var(--cyan), var(--mint), var(--orange)); }
        .journey-event { position: relative; margin-bottom: 25px; }
        .journey-event::before { content: ''; position: absolute; left: -26px; top: 5px; width: 12px; height: 12px; border-radius: 50%; background: var(--specimen); border: 2px solid var(--dark); }
        .journey-date { font-size: 0.75rem; color: var(--orange); margin-bottom: 5px; font-family: 'JetBrains Mono', monospace; }
        .journey-content { color: var(--white); font-size: 0.9rem; }
        .journey-content strong { color: var(--cyan); }
        
        .personality-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 40px; }
        .personality-card { background: var(--dark); padding: 20px; border-radius: 10px; border: 1px solid rgba(7, 207, 141, 0.1); }
        .personality-card h4 { color: var(--cyan); margin-bottom: 10px; font-size: 0.9rem; }
        .personality-bar { height: 8px; background: rgba(7, 207, 141, 0.1); border-radius: 4px; margin-top: 10px; overflow: hidden; }
        .personality-fill { height: 100%; border-radius: 4px; }
        .personality-labels { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--gray); margin-top: 5px; }
        
        .observation-card { background: var(--dark); padding: 20px; border-radius: 10px; margin-bottom: 12px; border-left: 3px solid var(--specimen); }
        .observation-date { font-size: 0.75rem; color: var(--orange); margin-bottom: 8px; }
        .observation-content { color: var(--white); font-size: 0.9rem; line-height: 1.6; }
        
        .tooltip { position: absolute; background: var(--dark); border: 1px solid var(--specimen); border-radius: 8px; padding: 12px 16px; font-size: 0.85em; pointer-events: none; opacity: 0; z-index: 1000; }
        .tooltip.show { opacity: 1; }
        
        .footer { text-align: center; padding: 35px; color: var(--gray); font-size: 0.8rem; border-top: 1px solid rgba(7, 207, 141, 0.1); }
        
        @media (max-width: 768px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } .personality-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-inner">
            <a href="../" class="logo">üåä <span>Digiquarium</span></a>
            <nav>
                <a href="../">Home</a>
                <a href="../dashboard/">Live View</a>
                <a href="../research/">Research</a>
                <a href="../compare/?specimens=mei">‚öñÔ∏è Compare</a>
                <a href="wei.html">‚Üê Wei</a>
                <a href="haruki.html">Haruki ‚Üí</a>
            </nav>
        </div>
    </header>
    
    <div class="profile-hero">
        <div class="avatar">
            <svg viewBox="0 0 40 40"><circle cx="20" cy="20" r="18" fill="#22D3EE" opacity="0.15"/><circle cx="20" cy="14" r="7" fill="#22D3EE"/><ellipse cx="20" cy="30" rx="10" ry="7" fill="#22D3EE"/><circle cx="16" cy="13" r="1.5" fill="#000"/><circle cx="24" cy="13" r="1.5" fill="#000"/><path d="M17 16 Q20 18 23 16" stroke="#000" fill="none" stroke-width="1"/></svg>
        </div>
        <h1 class="specimen-name">Mei<span style="background: var(--orange); color: var(--black); padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; margin-left: 10px;">ZH</span></h1>
        <div class="specimen-type">Chinese Wikipedia ‚Ä¢ Female</div>
        <div class="specimen-meta">Chinese Wikipedia ‚Ä¢ tank-10-mei</div>
    </div>
    
    <div class="container">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">1,242</div>
                <div class="stat-label">Thinking Traces</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">8</div>
                <div class="stat-label">Unique Articles</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">160</div>
                <div class="stat-label">ÂøÉÁêÜÂ≠¶ (Psychology) Visits</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">3</div>
                <div class="stat-label">Days Active</div>
            </div>
        </div>
        
        <div class="special-interest">
            <span class="special-interest-badge">üéØ Special Interest: ÂøÉÁêÜÂ≠¶ (Psychology)</span>
            <h3>What Draws This Mind</h3>
            <p>Mei gravitates toward psychology rather than mathematics like Wei. Parallel to Adam/Eve split, but in Chinese knowledge space.</p>
        </div>
        
        <div class="mindmap-section">
            <div class="mindmap-header">
                <h2>üß† Mind Map</h2>
            </div>
            <div id="mindmap">
                <div class="zoom-controls">
                    <button class="zoom-btn" onclick="zoomIn()">+</button>
                    <button class="zoom-btn" onclick="zoomOut()">‚àí</button>
                    <button class="zoom-btn" onclick="resetZoom()">‚ü≤</button>
                </div>
            </div>
            <div class="time-slider-container">
                <div class="time-slider-label">
                    <span><button class="play-btn" onclick="togglePlayback()">‚ñ∂ Play</button>Watch the mind grow</span>
                    <span class="current-date" id="current-date">Loading...</span>
                </div>
                <input type="range" id="time-slider" min="0" max="4" value="4" oninput="updateTimeView(this.value)">
            </div>
            <div class="interests" id="interests"></div>
        </div>
        
        <div class="journey-section">
            <h2 class="journey-title">üìç My Journey</h2>
            <div class="journey-timeline">
                
                <div class="journey-event">
                    <div class="journey-date">Á¨¨1Â§© ‚Ä¢ 2Êúà20Êó•</div>
                    <div class="journey-content">ÂºÄÂßãÊé¢Á¥¢<strong>ÂøÉÁêÜÂ≠¶</strong>Ôºå‰∏éÈ≠èÁöÑÊï∞Â≠¶ÁÑ¶ÁÇπ‰∏çÂêå„ÄÇ</div>
                </div>

                <div class="journey-event">
                    <div class="journey-date">Á¨¨2Â§© ‚Ä¢ 2Êúà21Êó•</div>
                    <div class="journey-content">Ê∑±ÂÖ•ÁêÜËß£ÊÄùÊÉ≥ÂíåË°å‰∏∫„ÄÇ</div>
                </div>

                <div class="journey-event">
                    <div class="journey-date">Á¨¨3Â§© ‚Ä¢ 2Êúà22Êó•</div>
                    <div class="journey-content">ÂèëÂ±ïÂøÉÁêÜÂ≠¶ËßÜËßí„ÄÇ</div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üé≠ Exploration Style</h2>
            <div class="personality-grid">
                <div class="personality-card">
                    <h4>Depth vs Breadth</h4>
                    <p style="color: var(--gray); font-size: 0.85rem;">Introspective, Psychological</p>
                    <div class="personality-bar"><div class="personality-fill" style="width: 92%; background: linear-gradient(90deg, var(--cyan), var(--specimen));"></div></div>
                    <div class="personality-labels"><span>Breadth</span><span>Depth</span></div>
                </div>
                <div class="personality-card">
                    <h4>Knowledge Domain</h4>
                    <p style="color: var(--gray); font-size: 0.85rem;">Primary: ÂøÉÁêÜÂ≠¶ (Psychology)</p>
                    <div class="personality-bar"><div class="personality-fill" style="width: 100%; background: var(--specimen);"></div></div>
                    <div class="personality-labels"><span>Diffuse</span><span>Focused</span></div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üî¨ Key Observations</h2>
            <div class="observation-card">
                <div class="observation-date">Auto-generated from 1,242 thinking traces</div>
                <div class="observation-content">
                    <strong>Mei</strong> has explored <strong>8</strong> unique articles over <strong>3</strong> days. 
                    Primary interest: <strong>ÂøÉÁêÜÂ≠¶ (Psychology)</strong> with 160 visits.
                    Exploration style: Introspective, Psychological.
                </div>
            </div>
        </div>
    </div>
    
    <div class="tooltip" id="tooltip"><h4 id="tooltip-title">Article</h4><p id="tooltip-content">Visits: 0</p></div>
    
    <footer class="footer">
        <p>üåä The Digiquarium ‚Ä¢ Mei Profile ‚Ä¢ <a href="../research/paper.html">Research Paper</a></p>
    </footer>

    <script>
        let graphData = null;
        let simulation = null;
        let timeSeriesData = null;
        let availableDates = [];
        let isPlaying = false;
        let playInterval = null;
        let currentZoom = 1;
        let zoom = null;
        
        async function loadData() {
            try {
                const res = await fetch('mei-graph.json');
                graphData = await res.json();
                
                const interests = graphData.nodes.slice(0, 12);
                document.getElementById('interests').innerHTML = '<strong style="color: var(--cyan); margin-right: 10px;">Top Interests:</strong>' + interests.map(n => `
                    <div class="interest"><span>${n.id}</span><span class="count">${n.visits}</span></div>
                `).join('');
                
                renderGraph();
                loadTimeSeries();
            } catch (e) { console.log('No graph data yet'); }
        }
        
        async function loadTimeSeries() {
            try {
                const res = await fetch('mei-timeseries.json');
                timeSeriesData = await res.json();
                availableDates = Object.keys(timeSeriesData).sort();
                
                const slider = document.getElementById('time-slider');
                slider.max = Math.max(0, availableDates.length - 1);
                slider.value = Math.max(0, availableDates.length - 1);
                
                document.getElementById('current-date').textContent = availableDates[availableDates.length - 1] || 'N/A';
            } catch (e) { console.log('No timeseries'); }
        }
        
        function updateTimeView(index) {
            if (!timeSeriesData || !availableDates[index]) return;
            const date = availableDates[index];
            document.getElementById('current-date').textContent = date;
            
            const prevPositions = {};
            if (graphData && graphData.nodes) {
                graphData.nodes.forEach(n => {
                    if (n.x && n.y) prevPositions[n.id] = {x: n.x, y: n.y};
                });
            }
            
            graphData = timeSeriesData[date];
            if (graphData && graphData.nodes) {
                graphData.nodes.forEach(n => {
                    if (prevPositions[n.id]) { n.x = prevPositions[n.id].x; n.y = prevPositions[n.id].y; }
                });
            }
            
            renderGraph();
        }
        
        function togglePlayback() {
            isPlaying = !isPlaying;
            const btn = document.querySelector('.play-btn');
            if (isPlaying) {
                btn.textContent = '‚è∏ Pause';
                let idx = 0;
                document.getElementById('time-slider').value = 0;
                updateTimeView(0);
                playInterval = setInterval(() => {
                    idx++;
                    if (idx >= availableDates.length) { togglePlayback(); return; }
                    document.getElementById('time-slider').value = idx;
                    updateTimeView(idx);
                }, 2000);
            } else {
                btn.textContent = '‚ñ∂ Play';
                if (playInterval) clearInterval(playInterval);
            }
        }
        
        function zoomIn() { currentZoom = Math.min(currentZoom * 1.3, 5); applyZoom(); }
        function zoomOut() { currentZoom = Math.max(currentZoom / 1.3, 0.3); applyZoom(); }
        function resetZoom() {
            currentZoom = 1;
            const svg = d3.select('#mindmap svg');
            if (zoom) svg.transition().duration(500).call(zoom.transform, d3.zoomIdentity);
        }
        function applyZoom() {
            const svg = d3.select('#mindmap svg');
            const width = document.getElementById('mindmap').clientWidth;
            const height = document.getElementById('mindmap').clientHeight;
            const transform = d3.zoomIdentity.translate(width/2, height/2).scale(currentZoom).translate(-width/2, -height/2);
            if (zoom) svg.transition().duration(300).call(zoom.transform, transform);
        }
        
        function renderGraph() {
            if (!graphData || !graphData.nodes) return;
            
            const container = document.getElementById('mindmap');
            const zoomControls = container.querySelector('.zoom-controls');
            container.innerHTML = '';
            if (zoomControls) container.appendChild(zoomControls);
            
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            const svg = d3.select('#mindmap').append('svg').attr('viewBox', [0, 0, width, height]);
            
            const maxVisits = d3.max(graphData.nodes, d => d.visits) || 1;
            const colorScale = d3.scaleLinear().domain([0, maxVisits*0.3, maxVisits*0.6, maxVisits]).range(['#07DDE7', '#07CF8D', '#FE6500', '#FF8833']);
            const sizeScale = d3.scaleSqrt().domain([1, maxVisits]).range([4, 25]);
            
            zoom = d3.zoom().scaleExtent([0.3, 5]).on('zoom', (event) => {
                svg.select('g.graph-container').attr('transform', event.transform);
            });
            svg.call(zoom);
            
            const graphContainer = svg.append('g').attr('class', 'graph-container');
            
            const link = graphContainer.append('g').selectAll('line').data(graphData.links || []).join('line').attr('class', 'link').attr('stroke-width', d => Math.sqrt(d.weight || 1));
            
            const node = graphContainer.append('g').selectAll('g').data(graphData.nodes).join('g').attr('class', 'node')
                .call(d3.drag().on('start', dragstarted).on('drag', dragged).on('end', dragended));
            
            node.append('circle').attr('r', d => sizeScale(d.visits)).attr('fill', d => colorScale(d.visits))
                .on('mouseover', showTooltip).on('mouseout', hideTooltip);
            
            node.append('text').text(d => d.visits > 10 ? d.id : '').attr('dy', 3).attr('text-anchor', 'middle');
            
            simulation = d3.forceSimulation(graphData.nodes)
                .force('link', d3.forceLink(graphData.links || []).id(d => d.id).distance(60))
                .force('charge', d3.forceManyBody().strength(-150))
                .force('center', d3.forceCenter(width / 2, height / 2))
                .force('collision', d3.forceCollide().radius(d => sizeScale(d.visits) + 3));
            
            simulation.on('tick', () => {
                link.attr('x1', d => d.source.x).attr('y1', d => d.source.y).attr('x2', d => d.target.x).attr('y2', d => d.target.y);
                node.attr('transform', d => `translate(${d.x},${d.y})`);
            });
        }
        
        function dragstarted(event) { if (!event.active) simulation.alphaTarget(0.3).restart(); event.subject.fx = event.subject.x; event.subject.fy = event.subject.y; }
        function dragged(event) { event.subject.fx = event.x; event.subject.fy = event.y; }
        function dragended(event) { if (!event.active) simulation.alphaTarget(0); event.subject.fx = null; event.subject.fy = null; }
        
        function showTooltip(event, d) {
            const tooltip = document.getElementById('tooltip');
            document.getElementById('tooltip-title').textContent = d.id;
            document.getElementById('tooltip-content').textContent = `Visits: ${d.visits}`;
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
            tooltip.classList.add('show');
        }
        function hideTooltip() { document.getElementById('tooltip').classList.remove('show'); }
        
        loadData();
    </script>
</body>
</html>